---
title: "Thesis Porfolio 1"
author: "Adam"
date: "4/4/2022"
output: html_document
---

The goal of this markdown is to properly clean data using R. Admittedly I think I've decided to do all my future data cleaning in SPSS because I find it easier, but it's worth the practice. Plus I need portfolios.

## Set-up

First, I need to ensure that I have the packages needed.


library('psych')
library('reshape2')
library('dplyr')
library('Rcpp')
library('readr')
library('tidyverse')

rm(list=ls())

##### Bringing in the data

Data downloaded from Qualtrics as a .csv. Some minor cleaning (removing incompleted responses) has already been done.

```{r bringing in data, echo=FALSE}
study1 <- read_csv("~/Master's Program Wake Forest/Research/Online Belonging/Thesis Study 1/Data for Portfolio/Portfolio 1 - cleaned (pre).csv")
View(study1)
```

>For some reason, this isn't letting the file knit? It's saying the function 'read_csv' can't be found, but the file is opening and 'readr' is the package that adds that function.

### Checking for bad data

Checking for bad actors in the data, before giving credit.

```{r checking the basics}
summary(study1$Durationinseconds)
```

```{r Filtering}
#looking narrowly at people under the 1st quartile (172)

filter(study1, Durationinseconds < 172) %>%
        arrange(Durationinseconds)
```

I found no straight-lining within this subset, which suggests to me that the data was all given in good faith. However, I wanted to look at another subset.

I filtered for students that answered positively on two items that previous research suggest should be opposite, belonging and feeling like an outsider.

```{r}
filter(study1, school_belong > 4, school_outsider > 4)
#40 students fall into this category

filter(study1, class_belong > 4, class_outsider > 4)
#18 students fall into class.

filter(study1, school_belong > 4, school_outsider > 4, class_belong > 4, class_outsider > 4)
#4 students fall into this category. Only one seemed suspicious, but passed along to Shannon to make a decision.

```

Ultimately, we decided to grant credit to all students. That means it's time to move on to cleaning the data.


## Data cleaning

Removing identifying information from the dataset.

```{r}
study1 <- subset(study1, select= -c(StartDate, EndDate, Status,	IPAddress, Progress,
                Finished, RecordedDate, ResponseId, RecipientLastName, RecipientFirstName,
                RecipientEmail, ExternalReference, LocationLatitude, LocationLongitude,
                DistributionChannel, UserLanguage))

```

The dataset opened above actually already has these removed since I am sharing this externally from the people listed on the IRB, but this is how they were removed.


### Descriptives cleaning

Now it's time to begin creating the dummy codes needed for my analyses.

##### Gender dummy coding

```{r checking gender demographics}
study1 %>%
        filter(is.na(demog_gender_female), is.na(demog_gender_male)) %>%
        count(demog_gender_trans, demog_gender_twospirit, demog_gender_genderqueer, demog_gender_other, demog_gender_no_answer)

study1 %>%
count(demog_gender_trans, demog_gender_twospirit, demog_gender_genderqueer, demog_gender_other, demog_gender_no_answer)

```

We have 12 people that did not identify as either male or female in some way. Due to this small number, there is not much we can do with the individual gender terms, so I am going to make two variables, gender_male & gender_nonbinary.


```{r making gender dummy code}
study1 %>%
        mutate(demog_gender_nonbin = 
                       case_when(demog_gender_trans == 1 & demog_gender_female == NA & demog_gender_male == NA ~ 1, 
                                 demog_gender_female == 1 ~ 0,
                                 demog_gender_male ==1 ~ 0,
                                 )) %>%
        select(demog_gender_nonbin, demog_gender_trans)
```

```{r}
study1 %>%
        mutate(V5 = case_when(demog_gender_female == 1 | demog_gender_male == 1 ~ 0
                              
                              )) %>%
        select(V5, demog_gender_female) %>%
        arrange(V5)
```

cleaning one

```{r}
test1 <- study1 %>%
        mutate(demog_gender_nonbin = case_when(is.na(demog_gender_female) & is.na(demog_gender_male) ~ 1 ))



test1 %>%
        select(demog_gender_nonbin, demog_gender_female, demog_gender_male, demog_gender_trans) %>%
        arrange(desc(demog_gender_trans))

```



& is.na(demog_gender_female) | is.na(demog_gender_male) 

```{r}
test1 <- study1 %>%
        mutate(demog_gender_nonbin = case_when((demog_gender_female != 1 | is.na(demog_gender_female) & (demog_gender_trans == 1 | demog_gender_twospirit == 1 | demog_gender_genderqueer == 1 | demog_gender_other == 1 | demog_gender_no_answer == 1)) |
        (demog_gender_male != 1 & (demog_gender_trans == 1 | demog_gender_twospirit == 1 | demog_gender_genderqueer == 1 | demog_gender_other == 1 | demog_gender_no_answer == 1) ~ 1 )))

test1 %>%
        select(demog_gender_nonbin, demog_gender_female, demog_gender_male, demog_gender_genderqueer, demog_gender_trans) %>%
        arrange(desc(demog_gender_genderqueer))



```



```{r}
test1 <- study1 %>%
        mutate(demog_gender_nonbin = case_when(demog_gender_trans == 1 | demog_gender_twospirit == 1 | demog_gender_genderqueer == 1 | demog_gender_other == 1 | demog_gender_no_answer == 1 ~ 1,  !is.na(demog_gender_male) ~ 0  ))



test1 %>%
        select(demog_gender_nonbin, demog_gender_female, demog_gender_male, demog_gender_genderqueer, demog_gender_trans) %>%
        arrange(desc(demog_gender_genderqueer))
```


select(demog_gender_dich, demog_gender_male, demog_gender_female)


study1 <- study1 %>%
        mutate(demog_gender_dich = demog_gender_female == 1) 
        
        
##### Race dummy coding


### Variables of Interest

##### Institutional belonging (belong_instit_comp4)


##### Class belonging (belong_class_comp4)


##### Class disclosure (cdiscl_disclose_comp3)


##### Class prompted disclosure (cdiscl__prompt_comp2)


#### Group disclosure (gdiscl_disclose_comp3)


##### Group prompted disclosure (gdiscl_prompt_comp2)